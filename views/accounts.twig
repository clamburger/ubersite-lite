{% extends "master.twig" %}

{% block title %}Account Management{% endblock %}

{% block content %}
<a href="/account-import">Import users from CSV</a>
<table>
<tr>
  <th>Role</th>
  <th>Username</th>
  <th>Name</th>
  <th>Small Group</th>
  <th>Controls</th>
</tr>
{% for row in users %}
<tr data-username="{{ row.username }}">
  <td class="userRole {{ row.role }}">{{ row.role }}</td>
  <td><strong>{{ row.username }}</strong></td>
  <td><input data-action="user-name" class="invisible small" type="text" value="{{ row.name }}"></td>
  <td><input data-action="user-smallgroup" class="invisible small" type="text" value="{{ row.smallGroup }}"></td>
  <td>
    {% if row.username != user.username %}
      <a data-action="delete-user">Delete</a>
    {% endif %}
  </td>
</tr>
{% endfor %}
</table>

<form method="POST" action="/accounts">
{% if editing %}
  <h2 id="new">Editing User:</h2>
  <input type="hidden" name='action' value='edit'>
  <input type="hidden" name='username' value='{{ form.username }}'>
{% else %}
  <h2 id="new">New User:</h2>
  <input type="hidden" name='action' value='new'>
{% endif %}
<table class='formTable'>
  <tr>
    <th><label for="username">Username:</label></th>
    <td>
    {% if editing %}
      <input id="username" value="{{ form.username }}" disabled>
    {% else %}
      <input type='text' id='username' name="username" value="{{ form.username }}" placeholder="Required" required>
    {% endif %}
    </td>
  </tr>
  <tr>
    <th><label for="name">Name:</label></th>
    <td><input type='text' name='name' id='name' value='{{ form.name }}' placeholder="Required" required></td>
  </tr>
  <tr>
    <th><label for="role">Role:</label></th>
    <td>
      <select name='role' id="role">
        {% for role in roles %}
          <option value="{{ role }}" {{ form.role == role ? 'selected' : '' }}>{{ role | capitalize }}</option>
        {% endfor %}
      </select>
    </td>
  </tr>
  <tr>
    <th><label for="dutyTeam">Small Group:</label></th>
    <td><input type='text' name='dutyTeam' id='dutyTeam' value='{{ form.smallGroup }}' placeholder="Optional"></td>
  </tr>
  <tr>
    <th colspan="2" class="submitRow">
    <input type='button' value="Cancel" onclick="document.location = '/accounts'" />
    <input type='submit' value="{{ editing ? 'Save User' : 'Create User' }}" />
    </th>
  </tr>
</table>
</form>
{% endblock %}
