{% extends "master.twig" %}

{% block title %}Account Management{% endblock %}

{% block content %}
{% if user.leader %}
  <a href="/account-import">Import users from CSV</a>
  <table>
  <tr>
    <th>Role</th>
    <th>Username</th>
    <th>Name</th>
    <th>Duty Team</th>
    <th>Manage</th>
  </tr>
  {% for row in users %}
  <tr>
    <td class="userRole {{ row.Role }}">{{ row.Role }}</td>
    <td><strong>{{ row.Username }}</strong></td>
    <td>{{ row.Name }}</td>
    <td>{{ row.DutyTeam }}</td>
    <td><a href='/accounts/edit/{{ row.Username }}#new'>Edit</a>
      {% if row.Username != user.Username %}
      | <a href='/accounts/delete/{{ row.Username }}'>Delete</a>
      {% endif %}
    </td>
  </tr>
  {% endfor %}
  </table>

  <form method="POST" action="/accounts">
  {% if editing %}
    <h2 id="new">Editing User:</h2>
    <input type="hidden" name='action' value='edit'>
    <input type="hidden" name='username' value='{{ form.Username }}'>
  {% else %}
    <h2 id="new">New User:</h2>
    <input type="hidden" name='action' value='new'>
  {% endif %}
  <table class='formTable'>
    <tr>
      <th><label for="username">Username:</label></th>
      <td>
      {% if editing %}
        <input id="username" value="{{ form.Username }}" disabled>
      {% else %}
        <input type='text' id='username' name="username" value="{{ form.Username }}" placeholder="Required" required>
      {% endif %}
      </td>
    </tr>
    <tr>
      <th><label for="name">Name:</label></th>
      <td><input type='text' name='name' id='name' value='{{ form.name }}' placeholder="Required" required></td>
    </tr>
    <tr>
      <th><label for="role">Role:</label></th>
      <td>
        <select name='role' id="role">
          {% for role, selected in roles %}
          <option value='{{ role }}' {{ selected ? 'selected' : '' }}>{{ role | capitalize }}</option>
          {% endfor %}
        </select>
      </td>
    </tr>
    <tr>
      <th><label for="dutyTeam">Duty Team:</label></th>
      <td><input type='text' name='dutyTeam' id='dutyTeam' value='{{ form.dutyTeam }}' placeholder="Optional"></td>
    </tr>
    <tr>
      <th colspan="2" class="submitRow">
      <input type='button' value="Cancel" onclick="document.location = '/accounts'" />
      <input type='submit' value="{{ editing ? 'Save User' : 'Create User' }}" />
      </th>
    </tr>
  </table>
  </form>
{% else %}
  You must be a leader to view this page.
{% endif %}
{% endblock %}
